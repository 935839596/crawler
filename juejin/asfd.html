<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="app.css">
    <style>

    </style>
</head>
<body>

<script>
    document.write("<h2 class=\"heading\">效果</h2>\n<p>先来看波完成效果图\n</p><figure><img alt=\"效果图\" src=\"https://user-gold-cdn.xitu.io/2017/12/14/16053523aafa2d76?w=692&amp;h=994&amp;f=gif&amp;s=5185769\"><figcaption></figcaption></figure><p></p>\n<h2 class=\"heading\">需求</h2>\n<p>输入4位或6位短信验证码，输入完成后收起键盘</p>\n<h2 class=\"heading\">实现步骤</h2>\n<h3 class=\"heading\">第一步</h3>\n<p><strong>布局排版</strong></p>\n<pre><code class=\"hljs bash\" lang=\"bash\">&lt;div class=<span class=\"hljs-string\">\"security-code-wrap\"</span>&gt;\n    &lt;label <span class=\"hljs-keyword\">for</span>=<span class=\"hljs-string\">\"code\"</span>&gt;\n      &lt;ul class=<span class=\"hljs-string\">\"security-code-container\"</span>&gt;\n        &lt;li class=<span class=\"hljs-string\">\"field-wrap\"</span> v-for=<span class=\"hljs-string\">\"(item, index) in number\"</span> :key=<span class=\"hljs-string\">\"index\"</span>&gt;\n          &lt;i class=<span class=\"hljs-string\">\"char-field\"</span>&gt;{{value[index] || placeholder}}&lt;/i&gt;\n        &lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/label&gt;\n    &lt;input ref=<span class=\"hljs-string\">\"input\"</span> class=<span class=\"hljs-string\">\"input-code\"</span> @keyup=<span class=\"hljs-string\">\"handleInput(<span class=\"hljs-variable\">$event</span>)\"</span> v-model=<span class=\"hljs-string\">\"value\"</span>\n           id=<span class=\"hljs-string\">\"code\"</span> name=<span class=\"hljs-string\">\"code\"</span> <span class=\"hljs-built_in\">type</span>=<span class=\"hljs-string\">\"tel\"</span> :maxlength=<span class=\"hljs-string\">\"number\"</span>\n           autocorrect=<span class=\"hljs-string\">\"off\"</span> autocomplete=<span class=\"hljs-string\">\"off\"</span> autocapitalize=<span class=\"hljs-string\">\"off\"</span>&gt;\n&lt;/div&gt;\n</code></pre><ul>\n<li>使用li元素来模拟输入框的显示，没有别的目的，就只是为了语义化，当然你也可以使用其他任意一个元素来模拟，比如div。</li>\n<li>使用label标签的好处在于它可以跟input的click事件关联上，一方面实现了语义化解决方案，另一方面也省去了我们通过js来唤起虚拟键盘。</li>\n</ul>\n<p><strong>隐藏输入框</strong></p>\n<pre><code class=\"hljs bash\" lang=\"bash\">.input-code {\n    position: absolute;\n    left: -9999px;\n    top: -99999px;\n    width: 0;\n    height: 0;\n    opacity: 0;\n    overflow: visible;\n    z-index: -1;\n}\n</code></pre><ul>\n<li>将真实的输入框定位到屏幕可视区域以外的地方，虚拟键盘被唤起时，就不会将页面往上顶了。所以你的验证码输入组件一定要放在虚拟键盘遮挡不了的地方。</li>\n</ul>\n<h3 class=\"heading\">第二步</h3>\n<p><strong>处理验证码输入</strong></p>\n<pre><code class=\"hljs bash\" lang=\"bash\"><span class=\"hljs-function\"><span class=\"hljs-title\">handleSubmit</span></span>() {\n    this.<span class=\"hljs-variable\">$emit</span>(<span class=\"hljs-string\">'input'</span>, this.value)\n},\nhandleInput(e) {\n    this.<span class=\"hljs-variable\">$refs</span>.input.value = this.value\n    <span class=\"hljs-keyword\">if</span> (this.value.length &gt;= this.number) {\n        this.hideKeyboard()\n    }\n    this.handleSubmit()\n}\n</code></pre><ul>\n<li>输入时，给输入框赋一次值，是为了解决android端上输入框失焦后重新聚焦，输入光标会定在第一位的前面，经过赋值再聚焦，光标的位置就会显示在最后一位后面。</li>\n</ul>\n<h3 class=\"heading\">第三步</h3>\n<p><strong>完成输入后关闭虚拟键盘</strong></p>\n<pre><code class=\"hljs bash\" lang=\"bash\"><span class=\"hljs-function\"><span class=\"hljs-title\">hideKeyboard</span></span>() {\n    // 输入完成隐藏键盘\n    document.activeElement.blur() // ios隐藏键盘\n    this.<span class=\"hljs-variable\">$refs</span>.input.blur() // android隐藏键盘\n}\n</code></pre><h2 class=\"heading\">组件完整代码</h2>\n<pre><code class=\"hljs bash\" lang=\"bash\">&lt;!--四位验证码输入框组件--&gt;\n&lt;template&gt;\n  &lt;div class=<span class=\"hljs-string\">\"security-code-wrap\"</span>&gt;\n    &lt;label <span class=\"hljs-keyword\">for</span>=<span class=\"hljs-string\">\"code\"</span>&gt;\n      &lt;ul class=<span class=\"hljs-string\">\"security-code-container\"</span>&gt;\n        &lt;li class=<span class=\"hljs-string\">\"field-wrap\"</span> v-for=<span class=\"hljs-string\">\"(item, index) in number\"</span> :key=<span class=\"hljs-string\">\"index\"</span>&gt;\n          &lt;i class=<span class=\"hljs-string\">\"char-field\"</span>&gt;{{value[index] || placeholder}}&lt;/i&gt;\n        &lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/label&gt;\n    &lt;input ref=<span class=\"hljs-string\">\"input\"</span> class=<span class=\"hljs-string\">\"input-code\"</span> @keyup=<span class=\"hljs-string\">\"handleInput(<span class=\"hljs-variable\">$event</span>)\"</span> v-model=<span class=\"hljs-string\">\"value\"</span>\n           id=<span class=\"hljs-string\">\"code\"</span> name=<span class=\"hljs-string\">\"code\"</span> <span class=\"hljs-built_in\">type</span>=<span class=\"hljs-string\">\"tel\"</span> :maxlength=<span class=\"hljs-string\">\"number\"</span>\n           autocorrect=<span class=\"hljs-string\">\"off\"</span> autocomplete=<span class=\"hljs-string\">\"off\"</span> autocapitalize=<span class=\"hljs-string\">\"off\"</span>&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n  <span class=\"hljs-built_in\">export</span> default {\n    name: <span class=\"hljs-string\">'SecurityCode'</span>,\n    // component properties\n    props: {\n      number: {\n        <span class=\"hljs-built_in\">type</span>: Number,\n        default: 4\n      },\n      placeholder: {\n        <span class=\"hljs-built_in\">type</span>: String,\n        default: <span class=\"hljs-string\">'-'</span>\n      }\n    },\n    // variables\n    <span class=\"hljs-function\"><span class=\"hljs-title\">data</span></span>() {\n      <span class=\"hljs-built_in\">return</span> {\n        value: <span class=\"hljs-string\">''</span>\n      }\n    },\n    methods: {\n      <span class=\"hljs-function\"><span class=\"hljs-title\">hideKeyboard</span></span>() {\n        // 输入完成隐藏键盘\n        document.activeElement.blur() // ios隐藏键盘\n        this.<span class=\"hljs-variable\">$refs</span>.input.blur() // android隐藏键盘\n      },\n      <span class=\"hljs-function\"><span class=\"hljs-title\">handleSubmit</span></span>() {\n        this.<span class=\"hljs-variable\">$emit</span>(<span class=\"hljs-string\">'input'</span>, this.value)\n      },\n      handleInput(e) {\n        this.<span class=\"hljs-variable\">$refs</span>.input.value = this.value\n        <span class=\"hljs-keyword\">if</span> (this.value.length &gt;= this.number) {\n          this.hideKeyboard()\n        }\n        this.handleSubmit()\n      }\n    }\n  }\n&lt;/script&gt;\n\n&lt;style scoped lang=<span class=\"hljs-string\">\"less\"</span>&gt;\n  .security-code-wrap {\n    overflow: hidden;\n  }\n\n  .security-code-container {\n    margin: 0;\n    padding: 0;\n    display: flex;\n    justify-content: center;\n    .field-wrap {\n      list-style: none;\n      display: block;\n      width: 40px;\n      height: 40px;\n      line-height: 40px;\n      font-size: 16px;\n      background-color: <span class=\"hljs-comment\">#fff;</span>\n      margin: 2px;\n      color: <span class=\"hljs-comment\">#000;</span>\n      .char-field {\n        font-style: normal;\n      }\n    }\n  }\n\n  .input-code {\n    position: absolute;\n    left: -9999px;\n    top: -99999px;\n    width: 0;\n    height: 0;\n    opacity: 0;\n    overflow: visible;\n    z-index: -1;\n  }\n\n&lt;/style&gt;\n</code></pre><h2 class=\"heading\">组件使用代码</h2>\n<pre><code class=\"hljs bash\" lang=\"bash\">&lt;security-code v-model=<span class=\"hljs-string\">\"authCode\"</span>&gt;&lt;/security-code&gt;\n</code></pre><h2 class=\"heading\">结束语</h2>\n<p>怎么样，484 so easy</p>\n<p>一开始的思路也是4个输入框，监听输入完成跳到下一个输入框，这样的做法也能达到目的，不过需要更多的代码去维护这个规则，不够优雅。</p>\n<p>目前的做法已经是我能想到最优的解决方案，如果你有更好的实现思路，还望不吝赐教。</p>\n")
    document.write("<h2 id=\"lin\">牛逼</h2><code>hhh</code>")
</script>
</body>
</html>